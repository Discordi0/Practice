
A cybersecurity incident has been announced. Incident Responders have swiftly collected a malware sample (`apple.exe`) from the implicated machine. Your responsibility now is to perform comprehensive analysis of this sample, conducting static, dynamic, and code analysis, in an effort to unravel as much as possible about the malware's functioning and modus operandi.

---

Download `additional_samples.zip` from this module's resources (available at the upper right corner) and transfer the .zip file to this section's target. Unzip `additional_samples.zip` (password: `infected`) and start analyzing `apple.exe`. Then, answer the questions below.


## Questions 

Q1: Enter the MD5 hash of the malware as your answer.

A: 1C7243C8F3586B799A5F9A2E4200AA92

For this module i had to set up my own w10 vm bc the provided was too slow.

With the Get-FileHash utility module i got the hash

![](../../Img/Pasted%20image%2020250712162123.png)

Q2: Does the malware employ packing techniques? Answer format: Yes/No

A: No

I used DiE (https://github.com/horsicq/Detect-It-Easy?tab=readme-ov-file) to check th file.

![](../../Img/Pasted%20image%2020250712163201.png)

Q3: It appears that the malware is dropping a .tmp file following the infection. Enter the complete name of this .tmp file as your answer. Answer format: _.tmp

A: brbconfig.tmp

I used x64dbg to open the apple file.
And searched in all modules for .tmp.

![](../../Img/Pasted%20image%2020250712163534.png)

Q4: Examine the communication patterns of the malware and provide the domain it interacts with as your answer. Answer format: _._._

A: brb.3dtuts.by

I kept using the search function in x64dbg until i found something interesting.

![](../../Img/Pasted%20image%2020250712164741.png)

I used this user agent to check the code and see if i got the answer.
But there was no answer there, so i put a breakpoint in it to see what happened (not a good idea, but a successful one).

![](../../Img/Pasted%20image%2020250712164947.png)

Q5: Does the malware achieve persistence by altering the Software\Microsoft\Windows\CurrentVersion\Run registry key? Answer format: Yes/No

A: Yes

Search function again to the rescue.

![](../../Img/Pasted%20image%2020250712165119.png)

I don't really know if the malware "achieves" persistence (bc i'm not fully executing it to check), but with the function there it's safe to assume that i could do it.

Q6: After which function in x64dbg should a breakpoint be placed to unveil the decrypted content of the .tmp file? Answer format: C__________t

A: CryptDecrypt

For this one, i had to use the hint.
With the breakpoint in place i looked at the code.

![](../../Img/Pasted%20image%2020250712170605.png)

Seems like that it's the answer.

![](../../Img/Pasted%20image%2020250712170655.png)


